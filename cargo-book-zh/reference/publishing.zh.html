<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">

<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>在 crates.io 上发布 - Rust Cargo 官书（非官方翻译)</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="Cargo ">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff" />

    <link rel="shortcut icon" href="../favicon.png">
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/general.css">
    <link rel="stylesheet" href="../css/chrome.css">
    <link rel="stylesheet" href="../css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
        rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../highlight.css">
    <link rel="stylesheet" href="../tomorrow-night.css">
    <link rel="stylesheet" href="../ayu-highlight.css">

    <!-- Custom theme stylesheets -->
    

    
</head>

<body class="light">
    <!-- Provide site root to javascript -->
    <script type="text/javascript">var path_to_root = "../";</script>

    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script type="text/javascript">
        try {
            var theme = localStorage.getItem('mdbook-theme');
            var sidebar = localStorage.getItem('mdbook-sidebar');

            if (theme.startsWith('"') && theme.endsWith('"')) {
                localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
            }

            if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
    </script>

    <!-- Set the theme before any content is loaded, prevents flash -->
    <script type="text/javascript">
        var theme;
        try { theme = localStorage.getItem('mdbook-theme'); } catch (e) { }
        if (theme === null || theme === undefined) { theme = 'light'; }
        document.body.className = theme;
        document.querySelector('html').className = theme + ' js';
    </script>

    <!-- Hide / unhide sidebar before it is displayed -->
    <script type="text/javascript">
        var html = document.querySelector('html');
        var sidebar = 'hidden';
        if (document.body.clientWidth >= 1080) {
            try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch (e) { }
            sidebar = sidebar || 'visible';
        }
        html.classList.remove('sidebar-visible');
        html.classList.add("sidebar-" + sidebar);
    </script>

    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        <ol class="chapter"><li class="affix"><a href="../index.zh.html">介绍</a></li><li><a href="../getting-started/index.zh.html"><strong aria-hidden="true">1.</strong> 入门</a></li><li><ol class="section"><li><a href="../getting-started/installation.zh.html"><strong aria-hidden="true">1.1.</strong> 安装</a></li><li><a href="../getting-started/first-steps.zh.html"><strong aria-hidden="true">1.2.</strong> Cargo 的第一步</a></li></ol></li><li><a href="../guide/index.zh.html"><strong aria-hidden="true">2.</strong> Cargo 指南</a></li><li><ol class="section"><li><a href="../guide/why-cargo-exists.zh.html"><strong aria-hidden="true">2.1.</strong> 为什么 Cargo 存在</a></li><li><a href="../guide/creating-a-new-project.zh.html"><strong aria-hidden="true">2.2.</strong> 创建一个新包</a></li><li><a href="../guide/working-on-an-existing-project.zh.html"><strong aria-hidden="true">2.3.</strong> 处理现有包</a></li><li><a href="../guide/dependencies.zh.html"><strong aria-hidden="true">2.4.</strong> 依赖</a></li><li><a href="../guide/project-layout.zh.html"><strong aria-hidden="true">2.5.</strong> 包装布局</a></li><li><a href="../guide/cargo-toml-vs-cargo-lock.zh.html"><strong aria-hidden="true">2.6.</strong> Cargo.toml 与 Cargo.lock</a></li><li><a href="../guide/tests.zh.html"><strong aria-hidden="true">2.7.</strong> 测试</a></li><li><a href="../guide/continuous-integration.zh.html"><strong aria-hidden="true">2.8.</strong> 持续集成</a></li><li><a href="../guide/build-cache.zh.html"><strong aria-hidden="true">2.9.</strong> 构建缓存</a></li></ol></li><li><a href="../reference/index.zh.html"><strong aria-hidden="true">3.</strong> Cargo 参考</a></li><li><ol class="section"><li><a href="../reference/specifying-dependencies.zh.html"><strong aria-hidden="true">3.1.</strong> 指定依赖项</a></li><li><a href="../reference/manifest.zh.html"><strong aria-hidden="true">3.2.</strong> 清单格式</a></li><li><a href="../reference/config.zh.html"><strong aria-hidden="true">3.3.</strong> 组态</a></li><li><a href="../reference/environment-variables.zh.html"><strong aria-hidden="true">3.4.</strong> 环境变量</a></li><li><a href="../reference/build-scripts.zh.html"><strong aria-hidden="true">3.5.</strong> 构建脚本</a></li><li><a href="../reference/publishing.zh.html" class="active"><strong aria-hidden="true">3.6.</strong> 在 crates.io 上发布</a></li><li><a href="../reference/pkgid-spec.zh.html"><strong aria-hidden="true">3.7.</strong> 包 ID 规格</a></li><li><a href="../reference/source-replacement.zh.html"><strong aria-hidden="true">3.8.</strong> 来源更换</a></li><li><a href="../reference/external-tools.zh.html"><strong aria-hidden="true">3.9.</strong> 外部工具</a></li><li><a href="../reference/unstable.zh.html"><strong aria-hidden="true">3.10.</strong> 不稳定的功能</a></li></ol></li><li><a href="../faq.zh.html"><strong aria-hidden="true">4.</strong> 常问问题</a></li><li><a href="../appendix/glossary.zh.html"><strong aria-hidden="true">5.</strong> 附录:词汇表</a></li></ol>
    </nav>

    <div id="page-wrapper" class="page-wrapper">

        <div class="page">
            
            <div id="menu-bar" class="menu-bar">
                <div id="menu-bar-sticky-container">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                            aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <!-- START - Rust Cookbook customization -->
                        <button id="edit-button" class="icon-button" type="button" title="Fork and edit" aria-label="Fork and edit"
                            aria-haspopup="true" aria-expanded="false" aria-controls="edit">
                            <i class="fa fa-edit">Edit</i>
                        </button>
                        <!-- END - Rust Cookbook customization -->
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme"
                            aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                            aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Rust Cargo 官书（非官方翻译)</h1>
                    
                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

            
            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..."
                        aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>
            

            <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
            <script type="text/javascript">
                document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                    link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                });
            </script>

            <!-- // START - Rust Cookbook customization -->
            <script>
                document.getElementById("edit-button").addEventListener("click", function () {
                    var editWindow = window.open("https://github.com/chinanf-boy/cargo-book-zh/edit/master/src/reference/publishing.zh.md");
                });</script>
            <!-- // END - Rust Cookbook customization -->

            <div id="content" class="content">
                <main>
                    <a class="header" href="#publishing-on-cratesio" id="publishing-on-cratesio"><h2>Publishing on crates.io</h2></a>
<p>一旦你有一个你想与世界分享的图书馆,就该发布它了<a href="https://crates.io/">crates.io</a>!发布包是指上载特定版本以进行托管<a href="https://crates.io/">crates.io</a>.</p>
<p>发布箱子时要小心,因为发布是<strong>常驻</strong>.永远不会覆盖该版本,并且无法删除代码.但是,可以发布的版本数量没有限制.</p>
<a class="header" href="#before-your-first-publish" id="before-your-first-publish"><h3>Before your first publish</h3></a>
<p>首先,你需要一个帐户<a href="https://crates.io/">crates.io</a>获取API令牌.为此,<a href="https://crates.io/">访问主页</a>并通过GitHub帐户登录(现在需要).在此之后,访问你的<a href="https://crates.io/me">帐号设定</a>页面并运行<code>cargo login</code>命令指定.</p>
<pre><code class="language-console">$ cargo login abcdefghijklmnopqrstuvwxyz012345
</code></pre>
<p>此命令将通知Cargo您的API令牌并将其存储在您的本地<code>~/.cargo/credentials</code>(以前是<code>~/.cargo/config</code>).请注意,此令牌是一个<strong>秘密</strong>不应与其他任何人分享.如果因任何原因泄漏,您应立即重新生成.</p>
<a class="header" href="#before-publishing-a-new-crate" id="before-publishing-a-new-crate"><h3>Before publishing a new crate</h3></a>
<p>请记住箱子上的名字<a href="https://crates.io/">crates.io</a>以先到先得的方式分配.一旦获得箱子名称,它就不能用于另一个箱子.</p>
<a class="header" href="#packaging-a-crate" id="packaging-a-crate"><h4>Packaging a crate</h4></a>
<p>下一步是将您的包装箱打包成可上传的格式<a href="https://crates.io/">crates.io</a>.为此,我们将使用<code>cargo package</code>子命令.这将把我们的整个包装箱全部打包成一个<code>*.crate</code>文件中<code>target/package</code>目录.</p>
<pre><code class="language-console">$ cargo package
</code></pre>
<p>作为一个额外的奖励,<code>*.crate</code>将独立于当前源树进行验证.之后<code>*.crate</code>已创建,已解压缩<code>target/package</code>然后从头开始构建,以确保构建成功的所有必要文件.可以使用.禁用此行为<code>--no-verify</code>旗.</p>
<p>现在是时候看看了<code>*.crate</code>文件,以确保您不会意外地打包2GB视频资产,或用于代码生成,集成测试或基准测试的大型数据文件.目前有10MB的上传大小限制<code>*.crate</code>文件.所以,如果大小<code>tests</code>和<code>benches</code>目录及其依赖项最多可达几MB,您可以将它们保存在包中;否则,最好排除它们.</p>
<p>在打包时,Cargo会自动忽略版本控制系统忽略的文件,但是如果要指定要忽略的额外文件集,则可以使用<code>exclude</code>清单中的关键:</p>
<pre><code class="language-toml">[package]
# ...
exclude = [
    &quot;public/assets/*&quot;,
    &quot;videos/*&quot;,
]
</code></pre>
<p>这个数组中每个元素的语法是什么<a href="https://github.com/rust-lang/glob">锈琅/水珠</a>接受.如果您宁愿使用白名单而不是黑名单,Cargo也支持<code>include</code>key,如果设置,则覆盖<code>exclude</code>键:</p>
<pre><code class="language-toml">[package]
# ...
include = [
    &quot;**/*.rs&quot;,
    &quot;Cargo.toml&quot;,
]
</code></pre>
<a class="header" href="#uploading-the-crate" id="uploading-the-crate"><h3>Uploading the crate</h3></a>
<p>现在我们已经有了<code>*.crate</code>文件准备好了,可以上传到<a href="https://crates.io/">crates.io</a>随着<code>cargo publish</code>命令.就是这样,你现在已经发布了你的第一个箱子!</p>
<pre><code class="language-console">$ cargo publish
</code></pre>
<p>如果你想跳过<code>cargo package</code>一步,<code>cargo publish</code>如果找不到副本,子命令将自动打包本地包.</p>
<p>一定要看看<a href="reference/manifest.html#package-metadata">您可以指定的元数据</a>确保您的箱子更容易被发现!</p>
<a class="header" href="#publishing-a-new-version-of-an-existing-crate" id="publishing-a-new-version-of-an-existing-crate"><h3>Publishing a new version of an existing crate</h3></a>
<p>要发布新版本,请更改<code>version</code>您指定的值<code>Cargo.toml</code>表现.记住<a href="reference/manifest.html#the-version-field">semver规则</a>.然后可选择运行<code>cargo package</code>如果你想检查一下<code>*.crate</code>发布前的新版本文件,然后运行<code>cargo publish</code>上传新版本.</p>
<a class="header" href="#managing-a-cratesio-based-crate" id="managing-a-cratesio-based-crate"><h3>Managing a crates.io-based crate</h3></a>
<p>包装箱的管理主要通过命令行完成<code>cargo</code>工具而不是<a href="https://crates.io/">crates.io</a>网络界面.为此,有一些子命令来管理包.</p>
<a class="header" href="#cargo-yank" id="cargo-yank"><h4><code>cargo yank</code></h4></a>
<p>在您发布实际上因某种原因而最终被破坏的箱子版本(语法错误,忘记包含文件等)时,可能会出现这种情况.对于诸如此类的情况,Cargo支持一个箱子版本的”猛拉”.</p>
<pre><code class="language-console">$ cargo yank --vers 1.0.1
$ cargo yank --vers 1.0.1 --undo
</code></pre>
<p>一个猛拉<strong>才不是</strong>删除任何代码.例如,此功能不用于删除意外上传的机密.如果发生这种情况,您必须立即重置这些秘密.</p>
<p>一个被淘汰的版本的语义是不能为该版本创建新的依赖项,但所有现有的依赖项继续有效.其中一个主要目标<a href="https://crates.io/">crates.io</a>是作为永久存档的板条箱,不会随着时间的推移而改变,允许删除版本将违背这一目标.基本上是一个猛拉意味着所有包装都带有<code>Cargo.lock</code>任何未来都不会破裂<code>Cargo.lock</code>生成的文件不会列出抽出的版本.</p>
<a class="header" href="#cargo-owner" id="cargo-owner"><h4><code>cargo owner</code></h4></a>
<p>箱子通常由不止一个人开发,或者主要维护者可能会随着时间而改变!箱子的所有者是唯一允许发布新版本箱子的人,但是所有者可以指定其他所有者.</p>
<pre><code class="language-console">$ cargo owner --add my-buddy
$ cargo owner --remove my-buddy
$ cargo owner --add github:rust-lang:owners
$ cargo owner --remove github:rust-lang:owners
</code></pre>
<p>给这些命令的所有者ID必须是GitHub用户名或GitHub团队.</p>
<p>如果给出了用户名<code>--add</code>,该用户成为”命名”所有者,拥有该箱子的完全权利.除了能够发布或抽出箱子的版本,他们还能够添加或删除所有者,<em>包含</em>做的主人<em>他们</em>所有者.毋庸置疑,你不应该让那些你不完全信任命名所有者的人.要成为命名所有者,用户必须已登录<a href="https://crates.io/">crates.io</a>先前.</p>
<p>如果给团队名称<code>--add</code>,该团队成为”团队”所有者,对板条箱的权利受到限制.虽然他们有权发布或放弃箱子的版本,但他们<em>不要</em>能够添加或删除所有者.除了更方便管理所有者群体之外,团队还可以更安全地防止所有者变得恶意.</p>
<p>团队的语法是目前的<code>github:org:team</code>(见上面的例子).要将团队添加为所有者,必须是该团队的成员.删除作为所有者的团队不适用此类限制.</p>
<a class="header" href="#github-permissions" id="github-permissions"><h3>GitHub permissions</h3></a>
<p>团队成员资格不是GitHub提供的简单公共访问权限,并且在使用它时可能会遇到以下消息:</p>
<blockquote>
<p>您似乎无权从GitHub查询必要的属性来完成此请求.您可能需要重新进行身份验证<a href="https://crates.io/">crates.io</a>授予阅读GitHub组织成员资格的权限.去吧<a href="https://crates.io/login">https://crates.io/login</a></p>
</blockquote>
<p>这基本上是”你试图查询团队,并且五个级别的成员访问控制中的一个拒绝了这个”的全能.这并不夸张.GitHub对团队访问控制的支持是企业级.</p>
<p>最可能的原因是您在添加此功能之前最后一次登录.我们最初要求<em>没有</em>GitHub在对用户进行身份验证时的权限,因为我们实际上并没有将用户的令牌用于登录以外的任何其他内容.但是,为了代表您查询团队成员资格,我们现在需要<a href="https://developer.github.com/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/">该<code>read:org</code>范围</a>.</p>
<p>您可以自由地拒绝我们这个范围,并且在团队介绍之前所做的一切都将继续有效.但是,您永远无法将团队添加为所有者,或者将团队作为团队所有者发布.如果您尝试这样做,您将收到上述错误.如果你试图发布一个你根本不拥有的箱子,你可能也会看到这个错误,但恰好有一个团队.</p>
<p>如果你改变主意,或者只是不确定是否<a href="https://crates.io/">crates.io</a>有足够的许可,你可以随时去<a href="https://crates.io/login">https://crates.io/login</a>,如果,将提示您获得许可<a href="https://crates.io/">crates.io</a>没有它想要的所有范围.</p>
<p>查询GitHub的另一个障碍是组织可能会主动拒绝第三方访问.要检查这一点,您可以访问:</p>
<pre><code>https://github.com/organizations/:org/settings/oauth_application_policy
</code></pre>
<p>哪里<code>:org</code>是组织的名称(例如rust-lang).你可能会看到类似的东西:</p>
<p><img src="images/org-level-acl.png" alt="Organization Access Control" /></p>
<p>你可以选择明确删除的地方<a href="https://crates.io/">crates.io</a>从您组织的黑名单,或只需按”删除限制”按钮,允许所有第三方应用程序访问此数据.</p>
<p>或者,何时<a href="https://crates.io/">crates.io</a>请求了<code>read:org</code>范围,您可以明确列入白名单<a href="https://crates.io/">crates.io</a>通过按其名称旁边的”授予访问权限”按钮查询有问题的组织:</p>
<p><img src="images/auth-level-acl.png" alt="Authentication Access Control" /></p>

                </main>

                <nav class="nav-wrapper" aria-label="Page navigation">
                    <!-- Mobile navigation buttons -->
                    
                    <a rel="prev" href="../reference/build-scripts.zh.html" class="mobile-nav-chapters previous" title="Previous chapter"
                        aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    

                    
                    <a rel="next" href="../reference/pkgid-spec.zh.html" class="mobile-nav-chapters next" title="Next chapter"
                        aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                    

                    <div style="clear: both"></div>
                </nav>
            </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
            
            <a href="../reference/build-scripts.zh.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter"
                aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>
            

            
            <a href="../reference/pkgid-spec.zh.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter"
                aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
            
        </nav>

    </div>

    

    
    <!-- Google Analytics Tag -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128555056-1"></script>
    
    <script type="text/javascript">
        var localAddrs = ["localhost", "127.0.0.1", ""];
        if (localAddrs.indexOf(document.location.hostname) === -1) {
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());

            gtag('config', 'UA-128555056-1');
        }
    </script>
    

    

    
    <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
    

    <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
    <script src="../book.js" type="text/javascript" charset="utf-8"></script>

    <!-- Custom JS scripts -->
    

    

</body>

</html>