   
  

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:title" content="Bevy - 资源" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://llever.com/bevyengine-cn&#x2F;getting-started&#x2F;resources&#x2F;" />
    <meta
      property="og:image"
      content="http://llever.com/bevyengine-cn/assets/bevy_logo_fill.png"
    />
    <meta
      property="og:description"
      content="Bevy is a refreshingly simple data-driven game engine built in Rust. It is free and open-source forever!"
    />
    <link
      rel="shortcut icon"
      type="image/png"
      href="&#x2F;bevyengine-cn/assets/favicon.png"
    />
    <link rel="stylesheet" href="&#x2F;bevyengine-cn/site.css" />
    <link
      href="&#x2F;bevyengine-cn/atom.xml"
      rel="alternate"
      type="application/atom+xml"
    />
    <title>Bevy - 资源</title>
    
<script src="&#x2F;bevyengine-cn/optional-helpers.js"></script>

  </head>

  <body>
    <div class="headerbar-container">
      <nav class="headerbar container">
        <a href="&#x2F;bevyengine-cn/" class="header-logo">
          <img
            src="&#x2F;bevyengine-cn/assets/bevy_logo_dark.svg"
            class="logo"
            alt="bevy logo"
          />
        </a>
        
        <a href="&#x2F;bevyengine-cn/" class="header-logo-mobile">
          <img
            src="&#x2F;bevyengine-cn/assets/bevy_icon_dark.svg"
            class="logo"
            alt="bevy icon"
          />
        </a>
        
        <div class="header-item header-message">
           Features 
        </div>
        <div class="header-item header-push"></div>
        



    


<a href="{{config.base_url}}&#x2f;" class="header-item" >
    Features
</a>

        



    


<a href="&#x2f;learn" class="header-item" >
    Learn
</a>

        



    


<a href="&#x2f;news" class="header-item" >
    News
</a>

        



    


<a href="&#x2f;community" class="header-item" >
    Community
</a>

        <a
          class="header-item header-button header-button-donate"
          href="https://github.com/sponsors/cart"
          >Donate
          <img
            src="&#x2F;bevyengine-cn/assets/heart.svg"
            class="header-button-donate-heart"
            alt="heart icon"
        /></a>
        <a
          class="header-item header-button"
          href="&#x2F;bevyengine-cn/learn/book_cn/getting-started/"
          >Get Started</a
        >
      </nav>
    </div>
    <section class="section">
      <div class="container">
<div class="book-page">
  <input type="checkbox" style="display: none" id="show-book-nav" />
  <nav class="book-nav" role="navigation">
     
    <ul class="book-nav-sections-container book-nav-sections">
       

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;introduction&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">1.</strong>
        简介
    </a>
    
</li>
  

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;getting-started&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.</strong>
        入门指南
    </a>
    
    <ul class="book-nav-sections book-nav-sections-indented">
        
        
        

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;getting-started&#x2F;setup&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.1.</strong>
        设置
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;getting-started&#x2F;apps&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.2.</strong>
        apps
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;getting-started&#x2F;ecs&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.3.</strong>
        ecs
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;getting-started&#x2F;plugins&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.4.</strong>
        插件
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;getting-started&#x2F;resources&#x2F;" class="book-nav-section-title-active book-nav-section-title" >
        <strong class="book-nav-section-number">2.5.</strong>
        资源
    </a>
    
</li>

        
    </ul>
    
</li>
  

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;next-steps&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">3.</strong>
        下一步
    </a>
    
</li>
  

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;contributing&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">4.</strong>
        贡献
    </a>
    
    <ul class="book-nav-sections book-nav-sections-indented">
        
        
        

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;contributing&#x2F;code&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">4.1.</strong>
        code
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;contributing&#x2F;docs&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">4.2.</strong>
        docs
    </a>
    
</li>

        
    </ul>
    
</li>
  

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;troubleshooting&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">5.</strong>
        troubleshooting
    </a>
    
</li>
  

<li class="book-nav-section">
    <a href="&#x2F;bevyengine-cn&#x2F;faq&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">6.</strong>
        faq
    </a>
    
</li>
 
    </ul>
    
  </nav>
  <div class="book-content">
                                                                                                
    <a
      id="book-pager-bar-previous"
      href="&#x2F;bevyengine-cn&#x2F;getting-started&#x2F;plugins&#x2F;"
      class="book-pager-bar book-pager-bar-previous"
    >
      <div class="book-pager-bar-icon book-pager-bar-icon-previous">
        <img
          src="&#x2F;bevyengine-cn/assets/pager_previous.svg"
          class="book-pager-image book-pager-image-left"
        />
      </div>
    </a>
         
    <a
      id="book-pager-bar-next"
      href="&#x2F;bevyengine-cn&#x2F;next-steps&#x2F;"
      class="book-pager-bar book-pager-bar-next"
    >
      <div class="book-pager-bar-icon book-pager-bar-icon-next">
        <img
          src="&#x2F;bevyengine-cn/assets/pager_next.svg"
          class="book-pager-image book-pager-image-right"
        />
      </div>
    </a>
    

    <h1>
       资源  
    </h1>
    <div class="media-content"><p><strong>实体(Entities)</strong> 和 <strong>组件(Components)</strong> 非常合适表示复杂的, 可查询的数据组. 但是大多数应用还是需要某种<code>全局唯一</code>数据. 在Bevy ECS中, 我们使用 <strong>资源(Resources)</strong> 来表示全局唯一数据.</p>
<p>这儿有一些可以被当做<strong>Resources</strong>的数据例子:</p>
<ul>
<li>时钟</li>
<li>资源集合 (声音, 纹理, 网格)</li>
<li>渲染器</li>
</ul>
<h2 id="yong-resourceslai-zhui-zong-shi-jian">用Resources来追踪时间</h2>
<p>让我们通过每2秒钟打印一次<code>hello</code>来解决应用的垃圾信息问题. 我们将通过
<a href="https:&#x2F;&#x2F;docs.rs/bevy_core&#x2F;latest&#x2F;bevy_core/struct.Time.html"><code>Time</code>
</a>资源来完成它. 该资源通过<code>add_plugins(DefaultPlugins)</code>自动添加到我们的应用中.</p>
<p>简单点, 从应用中删除<code>hello_world</code>系统. 这样我们只需要适配<code>greet_people</code>系统.</p>
<p>访问资源的方式与访问组件的方式基本相同. 你可以在你的系统中像这样访问<code>Time</code>资源:</p>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">fn </span><span style="color:#6699cc;">greet_people</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">time</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Res</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Time</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#f99157;">query</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Query</span><span style="color:#5fb3b3;">&lt;&amp;</span><span style="color:#cccece;">Name, With</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Person</span><span style="color:#5fb3b3;">&gt;&gt;) {
</span><span style="color:#cccece;">    </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> name </span><span style="color:#5fb3b3;">in</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">() {
</span><span style="color:#cccece;">        </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">hello {}!</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> name</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">);
</span><span style="color:#cccece;">    </span><span style="color:#5fb3b3;">}
</span><span style="color:#5fb3b3;">}
</span></pre>
<p><code>Res</code>和<code>ResMut</code>指针分别提供对资源的读写.</p>
<p><code>Time</code>的<code>delta_seconds</code>字段给我们提供了上一次更新以来所经过的时间. 但是为了每2秒钟运行一次系统(system), 我们必须跟踪经过的一系列更新的时间. 为了简化过程, Bevy提供了<code>Timer</code>类型. 让我们创建一个新的资源(<code>Timer</code>), 来追踪经过的时间.</p>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">struct </span><span style="color:#cccece;">GreetTimer</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">Timer</span><span style="color:#5fb3b3;">);
</span><span style="color:#cccece;">
</span><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">greet_people</span><span style="color:#5fb3b3;">(
</span><span style="color:#cccece;">    </span><span style="color:#f99157;">time</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Res</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Time</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">timer</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">ResMut</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">GreetTimer</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#f99157;">query</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Query</span><span style="color:#5fb3b3;">&lt;&amp;</span><span style="color:#cccece;">Name, With</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Person</span><span style="color:#5fb3b3;">&gt;&gt;) {
</span><span style="color:#cccece;">    </span><span style="color:#5f6364;">// update our timer with the time elapsed since the last update
</span><span style="color:#cccece;">    </span><span style="color:#5f6364;">// if the timer hasn&#39;t finished yet, we return
</span><span style="color:#cccece;">    </span><span style="color:#c594c5;">if </span><span style="color:#5fb3b3;">!</span><span style="color:#cccece;">timer</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0.</span><span style="color:#6699cc;">tick</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">time</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">delta_seconds</span><span style="color:#5fb3b3;">()).</span><span style="color:#6699cc;">just_finished</span><span style="color:#5fb3b3;">() {
</span><span style="color:#cccece;">        </span><span style="color:#c594c5;">return</span><span style="color:#5fb3b3;">;
</span><span style="color:#cccece;">    </span><span style="color:#5fb3b3;">}
</span><span style="color:#cccece;">
</span><span style="color:#cccece;">    </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> name </span><span style="color:#5fb3b3;">in</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">() {
</span><span style="color:#cccece;">        </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">hello {}!</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> name</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">);
</span><span style="color:#cccece;">    </span><span style="color:#5fb3b3;">}
</span><span style="color:#5fb3b3;">}
</span></pre>
<p>现在剩下的就是把<code>GreetTimer</code>这个资源添加到我们的<code>HelloPlugin</code>中:</p>
<pre style="background-color:#2b2c2f;">
<span style="color:#c594c5;">impl </span><span style="color:#cccece;">Plugin </span><span style="color:#c594c5;">for </span><span style="color:#cccece;">HelloPlugin </span><span style="color:#5fb3b3;">{
</span><span style="color:#cccece;">    </span><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">build</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#f99157;">self</span><span style="color:#cccece;">, </span><span style="color:#f99157;">app</span><span style="color:#5fb3b3;">: &amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> AppBuilder</span><span style="color:#5fb3b3;">) {
</span><span style="color:#cccece;">        </span><span style="color:#5f6364;">// the reason we call from_seconds with the true flag is to make the timer repeat itself
</span><span style="color:#cccece;">        </span><span style="color:#cccece;">app</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_resource</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">GreetTimer</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">Timer</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">from_seconds</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">2.0</span><span style="color:#5fb3b3;">, </span><span style="color:#f99157;">true</span><span style="color:#5fb3b3;">)))
</span><span style="color:#cccece;">            </span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_startup_system</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">add_people</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">system</span><span style="color:#5fb3b3;">())
</span><span style="color:#cccece;">            </span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_system</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">greet_people</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">system</span><span style="color:#5fb3b3;">());
</span><span style="color:#cccece;">    </span><span style="color:#5fb3b3;">}
</span><span style="color:#5fb3b3;">}
</span></pre>
<p>现在, <code>cargo run</code>这个App, 它将以比较合理的方式向人们打招呼.</p>
</div>
    <div class="book-pagers" />
  </div>
</div>

</div>
    </section>
  </body>
</html>
