var L=Object.defineProperty,P=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var b=(t,e,s)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,g=(t,e)=>{for(var s in e||(e={}))I.call(e,s)&&b(t,s,e[s]);if(y)for(var s of y(e))T.call(e,s)&&b(t,s,e[s]);return t},h=(t,e)=>P(t,R(e));import{r as w,am as C,ae as j,aj as V,o as k,e as S,ai as $,u as B,b as M,d as m,f as i,w as p,n as _,j as N}from"./vendor.299a0f4c.js";import{_ as x}from"./index.3f9869dd.js";import{s as D}from"./storage.691bfb87.js";const U={setup(){const t=w(null),e=C({pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",width:120,height:40,imgCode:""});j(()=>{e.imgCode=d()});const s=()=>{e.imgCode=d()},n=(o,a)=>parseInt(Math.random()*(a-o)+o),l=(o,a)=>{const r=n(o,a),u=n(o,a),c=n(o,a);return`rgb(${r},${u},${c})`},d=()=>{const o=t.value.getContext("2d");o.fillStyle=l(180,230),o.fillRect(0,0,e.width,e.height);let a="";for(let r=0;r<4;r++){const u=e.pool[n(0,e.pool.length)];a+=u;const c=n(18,40),v=n(-30,30);o.font=c+"px Simhei",o.textBaseline="top",o.fillStyle=l(80,150),o.save(),o.translate(30*r+15,15),o.rotate(v*Math.PI/180),o.fillText(u,-15+5,-15),o.restore()}for(let r=0;r<5;r++)o.beginPath(),o.moveTo(n(0,e.width),n(0,e.height)),o.lineTo(n(0,e.width),n(0,e.height)),o.strokeStyle=l(180,230),o.closePath(),o.stroke();for(let r=0;r<40;r++)o.beginPath(),o.arc(n(0,e.width),n(0,e.height),1,0,2*Math.PI),o.closePath(),o.fillStyle=l(150,200),o.fill();return a};return h(g({},V(e)),{verify:t,handleDraw:s})}},q={class:"img-verify"},E=["width","height"];function z(t,e,s,n,l,d){return k(),S("div",q,[$("canvas",{ref:"verify",width:t.width,height:t.height,onClick:e[0]||(e[0]=(...o)=>n.handleDraw&&n.handleDraw(...o))},null,8,E)])}var A=x(U,[["render",z]]);const F={name:"Login",components:{vueImgVerify:A},setup(){const t=w(null),e=C({username:"",password:"",username1:"",password1:"",type:"login",imgCode:"",verify:""}),s=B(),n=M(),l=o=>{if(console.log("submit",o),console.log("verifyRef.value.imgCode",t.value.imgCode),e.imgCode=t.value.imgCode||"",e.verify.toLowerCase()!=e.imgCode.toLowerCase()){_.fail("\u9A8C\u8BC1\u7801\u6709\u8BEF");return}if(console.log("\u9A8C\u8BC1\u7801\u901A\u8FC7"),e.type=="login"){let a=n.state.user;D("token","hastoken"),e.username==a.name&&e.password==a.password&&(_.success({message:"\u767B\u5F55\u6210\u529F",duration:1e3}),s.push("/"))}else _.success("\u6CE8\u518C\u6210\u529F")},d=()=>s.go(-1);return h(g({},V(e)),{onSubmit:l,back:d,verifyRef:t})}},G={style:{margin:"16px"}},H=N(" \u63D0\u4EA4 ");function J(t,e,s,n,l,d){const o=m("van-nav-bar"),a=m("van-field"),r=m("vue-img-verify"),u=m("van-cell-group"),c=m("van-button"),v=m("van-form");return k(),S("div",null,[i(o,{title:"\u767B\u5F55/\u6CE8\u518C","left-text":"\u8FD4\u56DE","left-arrow":"",onClickLeft:n.back},null,8,["onClickLeft"]),i(v,{onSubmit:n.onSubmit},{default:p(()=>[i(u,{inset:""},{default:p(()=>[i(a,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=f=>t.username=f),name:"\u7528\u6237\u540D",label:"\u7528\u6237\u540D",placeholder:"\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D"}]},null,8,["modelValue"]),i(a,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=f=>t.password=f),type:"password",name:"\u5BC6\u7801",label:"\u5BC6\u7801",placeholder:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801"}]},null,8,["modelValue"]),i(a,{center:"",clearable:"",label:"\u9A8C\u8BC1\u7801",placeholder:"\u8F93\u5165\u9A8C\u8BC1\u7801",modelValue:t.verify,"onUpdate:modelValue":e[2]||(e[2]=f=>t.verify=f)},{button:p(()=>[i(r,{ref:"verifyRef"},null,512)]),_:1},8,["modelValue"])]),_:1}),$("div",G,[i(c,{round:"",block:"",type:"primary","native-type":"submit"},{default:p(()=>[H]),_:1})])]),_:1},8,["onSubmit"])])}var X=x(F,[["render",J]]);export{X as default};
